<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>blk</title><!-- for google analytics -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QNNF19VZGH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-QNNF19VZGH');
</script>

<!-- lambda icon, frail attempt -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%221em%22 font-size=%22100%22 color=%22red%22>Î»</text></svg>">
<!-- not-so-awesome awesome font -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="stylesheet" href="/main.css">
<!-- for dark mode -->
<script src="darkmode.js"></script>
<script src="main.js"></script>
<script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
<div id="preamble" class="status">
<div class="navbar">
  <a href='/'>home</a>
  <a href='/blog.html'>blog</a>
  <a href='/search.html'>search</a>
  <a href='/about.html'>about</a>
  <div id="darkModeToggle" onclick="toggleDarkMode()">
    &#9680; <!-- Circle with left half black -->
  </div>
</div>
<div class="toc">
  <span class="toc-title-container">
    <a class='feather' data-feather='menu'></a>
    <span class="toc-title">table of contents</span>
  </span>
  <div class="toc-list">
  </div>
</div><h1 class="main-title">blk</h1><span class="desc">text navigation on your terms</span><span class='date'>2024-04-14</span>
</div>
<div id="content" class="content">
<div id="outline-container-orgc57cdab" class="outline-2">
<h2 id="orgc57cdab">introduction</h2>
<div class="outline-text-2" id="text-orgc57cdab">
<p>
<a href="https://github.com/mahmoodsh36/blk">blk</a> tries to generalize the idea of creating and navigating titles of text files, as well as making links from one file to another, or one block to another (possibly in different files). if you have used org-roam, denote, or other similar tools like obsidian and logseq, you would know that inserting links between two files (or nodes, as they're usually called) and navigating them is a must-have feature for note-taking, with <code>blk</code>, instead of restricting links to specific elements of text, such as a file or a heading, we can insert links to arbitrary forms of text, be it links to an org heading (or markdown heading), or a code block in an org file, or even links to python functions, elisp functions, or an html element (by its id).
</p>
</div>
</div>
<div id="outline-container-org622daa5" class="outline-2">
<h2 id="org622daa5">motivation</h2>
<div class="outline-text-2" id="text-org622daa5">
<p>
most note-taking packages introduce rules or syntaxes of their own, for example, <code>org-roam</code> inserts something akin to the following text to identify headers and files (which, by the way, <code>blk</code> knows how to handle):
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">:PROPERTIES:
:ID: &lt;some-random-id-here&gt;
:END:
</pre>
</div>

<p>
while this may be sufficient for most, it wasnt flexible enough for my use case, what if i wanted to identify a specific code block by a unique string like <code>org-roam</code> does for headers and files? what if i wanted to identify a list item? say i wanted to write down the axioms of a vector space and i do it in the following manner in my <code>org-mode</code> file:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+begin_definition</span>
a /vector space/ is a set that satisfies the following axioms:
- closure of addition,
- closure of multiplication
- closure of..
- etc..
<span style="color: #fb4933;">#+end_definition</span>
</pre>
</div>

<p>
so far, so good. but what if i wanted to write the following text in another org file:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">consider the second axiom of vector spaces, we..
</pre>
</div>

<p>
shouldnt the text <b>second axiom</b> be clickable, and shouldnt it redirect the user to the third axiom of the definition we have above when clicked? an <code>org-roam</code> user would most likely insert a link to the header or the file containing the definition, but this isnt precise enough. first, it doesnt send the user to the axiom itself. second, the file <i>may</i> contain other text which would make finding the axiom the text refers to even less trivial.
</p>

<p>
to accommodate this, <code>blk</code> <i>suggests</i> the following syntax:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+begin_definition</span>
a vector space is a set that satisfies the following axioms:
- closure of addition,
- <span style="color: #fb4933;">&lt;&lt;&lt;vecspace-axiom-2&gt;&gt;&gt;</span>closure of multiplication
- closure of..
- etc..
<span style="color: #fb4933;">#+end_definition</span>
</pre>
</div>

<p>
this is what the org mode documentation refers to as a <a href="https://orgmode.org/manual/Radio-Targets.html">named target</a>. org mode by default allows linking to a named target using the text <code>[[named-target-here]]</code>, so for the target above, we would write:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">consider the <span style="color: #fb4933;">[[vecspace-axiom-2][second axiom]]</span> of vector spaces, we..
</pre>
</div>

<p>
but as one might guess, this only works when the both the definition and the link exist in the same file, what <code>blk</code> suggests is simply the following:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">consider the <span style="color: #fb4933;">[[blk:vecspace-axiom-2][second axiom]]</span> of vector spaces, we..
</pre>
</div>

<p>
this way, no matter where you place the link, it would work, in another org file, in another markdown file, or in any other type of text file you would want (as long as a rule is defined for it, the predefined rules should cover some common use-cases such as this).
</p>

<p>
again, so far so good, but the text <b>vecspace-axiom-2</b> acts as an "id" and may be hard to remember each time you want to pull up the definition of a vector space. so again, to accommodate this, blk suggest to rewrite the definition block as the following:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+name</span>: vecspace
<span style="color: #fb4933;">#+begin_definition</span> <span style="color: #fb4933;">:title</span> vector space
a vector space is a set that satisfies the following axioms:
- closure of addition,
- <span style="color: #fb4933;">&lt;&lt;&lt;vecspace-axiom-2&gt;&gt;&gt;</span>closure of multiplication
- closure of..
- etc..
<span style="color: #fb4933;">#+end_definition</span>
</pre>
</div>

<p>
better yet, the <code>#+name</code> property can be written on the same line as the <code>title</code> property:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+begin_definition</span> <span style="color: #fb4933;">:title</span> vector space <span style="color: #fb4933;">:name</span> vecspace
a vector space is a set that satisfies the following axioms:
- closure of addition,
- <span style="color: #fb4933;">&lt;&lt;&lt;vecspace-axiom-2&gt;&gt;&gt;</span>closure of multiplication
- closure of..
- etc..
<span style="color: #fb4933;">#+end_definition</span>
</pre>
</div>

<p>
in both cases, <code>blk-find</code> can be invoked, and the user can navigate to the definition by its title "vector space", and if the user wants, they can even rewrite the cross-reference of the text we considered before to link to the definition too, in the following manner:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">consider the <span style="color: #fb4933;">[[blk:vecspace-axiom-2][second axiom]]</span> of <span style="color: #fb4933;">[[blk:vecspace][vector space]]</span>s, we..
</pre>
</div>

<p>
or, if the user enables <code>blk-treat-titles-as-ids</code> (set to <code>t</code>), they can write the following:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">consider the <span style="color: #fb4933;">[[blk:vecspace-axiom-2][second axiom]]</span> of <span style="color: #fb4933;">[[blk:vector space]]</span>s, we..
</pre>
</div>

<p>
when opened, both links would redirect to the second axiom, and the definition, respectively. (notice that the keywords <code>:title</code> and <code>:name</code> are supported for any type of block, not only <code>#+begin_definition</code> blocks, so we can use them for a <code>#+begin_theorem</code>, for example.)
again, so far so good. but what if we want to write some code that makes heavy use of mathematics, and for some reason we wanted to refer to the definition of a vector space in our code, how would we do this? simple enough:
</p>
<div class="org-src-container" data-language="emacs-lisp">
<pre class="src src-emacs-lisp"><span style="color: #458588;">(</span><span style="color: #fb4933;">defun</span> <span style="color: #fabd2f;">my-function</span> <span style="color: #b16286;">()</span>
  <span style="color: #b8bb26;">"this function does the following etc... refer to the definition of a [[blk:vector space]]"</span>
  <span style="color: #b16286;">(</span>message <span style="color: #b8bb26;">"magic!"</span><span style="color: #b16286;">)</span><span style="color: #458588;">)</span>
</pre>
</div>

<p>
as expected, when the function <code>blk-open-at-point</code> is invoked at the link, emacs takes us to the definition of a vector space.
</p>

<p>
notice that for this to work, blk has to find the mentioned files in the directories listed in the variable <code>blk-directories</code> (it would search recursively if <code>blk-search-recursively</code> is set to <code>t</code>).
</p>

<p>
we can take things even further and use transclusions. say we want to not just <b>link</b> to the definition, but to insert it into the current document, without having to copy it from the other file and paste it into the current document, which would mean that modifiying one of them would cause the other to be "outdated", this is done using <code>blk</code>'s integration with <code>org-transclusion</code>:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">consider the following definition of a vector space:
<span style="color: #fb4933;">#+transclude</span>: <span style="color: #fb4933;">[[blk:vecspace]]</span>
</pre>
</div>

<p>
to expand the transclusion we can use <code>M-x org-transclusion-mode</code>.
</p>

<p>
this workflow is demonstrated in the following gif:

<video controls muted>
  <source src='/demo.mp4' type='video/mp4'>
your browser does not support the video tag.
</video>
</p>
</div>
</div>
<div id="outline-container-org6662b3e" class="outline-2">
<h2 id="org6662b3e">main features</h2>
<div class="outline-text-2" id="text-org6662b3e">
<ul class="org-ul">
<li>linking to any type of text, without having to worry about filenames or the location of the text itself.</li>
<li>navigating text elements by their titles, including support for outline navigation, e.g. the outline for an org src block: <code>file/heading/block</code>.</li>
<li>support for alises to any title, so that any text element can be navigated to by its "main" title or one of its aliases (this includes org files, for an example).</li>
</ul>
</div>
<div id="outline-container-org2863407" class="outline-3">
<h3 id="org2863407">org-mode specific features</h3>
<div class="outline-text-3" id="text-org2863407">
<ul class="org-ul">
<li>links to org-mode special blocks.</li>
<li>links to an arbitrary point in any org-mode file defined by <code>&lt;&lt;&lt;id-here&gt;&gt;&gt;</code> (cross-file target links).</li>
<li>transclusion of latex environments from an <code>org</code> or <code>tex</code> file into another org file, by its <code>\label</code>.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgcef2c83" class="outline-2">
<h2 id="orgcef2c83">basic setup</h2>
<div class="outline-text-2" id="text-orgcef2c83">
<div class="org-src-container" data-language="emacs-lisp">
<pre class="src src-emacs-lisp"><span style="color: #458588;">(</span><span style="color: #fb4933;">use-package</span> blk
  <span style="color: #fe8019;">:straight</span> <span style="color: #b16286;">(</span>blk <span style="color: #fe8019;">:host</span> github <span style="color: #fe8019;">:repo</span> <span style="color: #b8bb26;">"mahmoodsh36/blk"</span><span style="color: #b16286;">)</span> <span style="color: #7c6f64;">;; </span><span style="color: #7c6f64;">replace with :quelpa if needed</span>
  <span style="color: #fe8019;">:after</span> <span style="color: #b16286;">(</span>org<span style="color: #b16286;">)</span>
  <span style="color: #fe8019;">:config</span>
  <span style="color: #b16286;">(</span><span style="color: #fb4933;">setq</span> blk-directories
        <span style="color: #8ec07c;">(</span>list <span style="color: #d65d0e;">(</span>expand-file-name <span style="color: #b8bb26;">"~/notes"</span><span style="color: #d65d0e;">)</span>
              user-emacs-directory<span style="color: #8ec07c;">)</span><span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span>add-hook 'org-mode-hook #'blk-enable-completion<span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span><span style="color: #fb4933;">setq</span> blk-use-cache t<span style="color: #b16286;">)</span> <span style="color: #7c6f64;">;; </span><span style="color: #7c6f64;">makes completion faster</span>
  <span style="color: #b16286;">(</span>global-set-key <span style="color: #8ec07c;">(</span>kbd <span style="color: #b8bb26;">"C-c o"</span><span style="color: #8ec07c;">)</span> #'blk-open-at-point<span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span>global-set-key <span style="color: #8ec07c;">(</span>kbd <span style="color: #b8bb26;">"C-c f"</span><span style="color: #8ec07c;">)</span> #'blk-find<span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span>global-set-key <span style="color: #8ec07c;">(</span>kbd <span style="color: #b8bb26;">"C-c i"</span><span style="color: #8ec07c;">)</span> #'blk-insert<span style="color: #b16286;">)</span><span style="color: #458588;">)</span>
</pre>
</div>

<p>
if you want the transclusion functionality, you have to enable it after installing org-transclusion:
</p>
<div class="org-src-container" data-language="emacs-lisp">
<pre class="src src-emacs-lisp"><span style="color: #458588;">(</span><span style="color: #fb4933;">use-package</span> org-transclusion
  <span style="color: #fe8019;">:config</span>
  <span style="color: #b16286;">(</span>add-hook 'org-mode-hook #'org-transclusion-mode<span style="color: #b16286;">)</span><span style="color: #458588;">)</span>

<span style="color: #458588;">(</span><span style="color: #fb4933;">use-package</span> blk
  <span style="color: #fe8019;">:straight</span> <span style="color: #b16286;">(</span>blk <span style="color: #fe8019;">:host</span> github <span style="color: #fe8019;">:repo</span> <span style="color: #b8bb26;">"mahmoodsh36/blk"</span><span style="color: #b16286;">)</span> <span style="color: #7c6f64;">;; </span><span style="color: #7c6f64;">replace with :quelpa if needed</span>
  <span style="color: #fe8019;">:after</span> <span style="color: #b16286;">(</span>org org-transclusion<span style="color: #b16286;">)</span>
  <span style="color: #fe8019;">:config</span>
  <span style="color: #b16286;">(</span><span style="color: #fb4933;">setq</span> blk-directories
        <span style="color: #8ec07c;">(</span>list <span style="color: #d65d0e;">(</span>expand-file-name <span style="color: #b8bb26;">"~/notes"</span><span style="color: #d65d0e;">)</span>
              user-emacs-directory<span style="color: #8ec07c;">)</span><span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span>add-hook 'org-mode-hook #'blk-enable-completion<span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span>blk-configure-org-transclusion<span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span><span style="color: #fb4933;">setq</span> blk-use-cache t<span style="color: #b16286;">)</span> <span style="color: #7c6f64;">;; </span><span style="color: #7c6f64;">makes completion faster</span>
  <span style="color: #b16286;">(</span>global-set-key <span style="color: #8ec07c;">(</span>kbd <span style="color: #b8bb26;">"C-c o"</span><span style="color: #8ec07c;">)</span> #'blk-open-at-point<span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span>global-set-key <span style="color: #8ec07c;">(</span>kbd <span style="color: #b8bb26;">"C-c f"</span><span style="color: #8ec07c;">)</span> #'blk-find<span style="color: #b16286;">)</span>
  <span style="color: #b16286;">(</span>global-set-key <span style="color: #8ec07c;">(</span>kbd <span style="color: #b8bb26;">"C-c i"</span><span style="color: #8ec07c;">)</span> #'blk-insert<span style="color: #b16286;">)</span><span style="color: #458588;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6bf69f8" class="outline-2">
<h2 id="org6bf69f8">demonstration of features</h2>
<div class="outline-text-2" id="text-org6bf69f8">
</div>
<div id="outline-container-orgdf40e80" class="outline-3">
<h3 id="orgdf40e80">org-mode files</h3>
<div class="outline-text-3" id="text-orgdf40e80">
<p>
by default, blk has rules in place to recognize org-mode files that are titled and id'd in the following manner (the usual way):
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">:PROPERTIES:
:ID:       0e7165f6-27e8-4e56-a342-b00572b7fff2
:END:
<span style="color: #fb4933;">#+title</span>: my-title-here
</pre>
</div>

<p>
this kind of id is inserted (as usual, but not necessarily), by <code>org-id-get-create</code>.
</p>

<p>
or, as an alternative (as inspired by the package <code>denote</code>):
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+title</span>: my-title-here
<span style="color: #fb4933;">#+identifier</span>: my-id-here
</pre>
</div>

<p>
so a link to such an org file would have the format <code>[[blk:my-id-here]]</code> or <code>[[blk:my-id-here][link description here]]</code>.
</p>

<p>
in addition, the title of an org-file can have an alias:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+title</span>: my-title-here
<span style="color: #fb4933;">#+identifier</span>: my-id-here
<span style="color: #fb4933;">#+alias</span>: my-second-title-here
<span style="color: #fb4933;">#+alias</span>: my-third-title-here
</pre>
</div>

<p>
so that the file can be navigated to either by the main title, or its aliases.
</p>
</div>
</div>
<div id="outline-container-orgae59847" class="outline-3">
<h3 id="orgae59847">org-mode blocks</h3>
<div class="outline-text-3" id="text-orgae59847">
<p>
blk has rules in place to recognize org-mode special-blocks (or src-blocks) that are written in the following way:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+begin_blockname</span> <span style="color: #fb4933;">:name</span> my-block <span style="color: #fb4933;">:title</span> my title
this is my block
<span style="color: #fb4933;">#+end_blockname</span>
</pre>
</div>

<p>
where <code>blockname</code> in <code>begin_blockname</code> and <code>end_blockname</code> is replaced by any other value.
</p>

<p>
or, as an alternative (this aligns with how org-babel identifies src blocks):
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+name</span>: my-block
<span style="color: #fb4933;">#+begin_blockname</span> <span style="color: #fb4933;">:title</span> my title
this is my block
<span style="color: #fb4933;">#+end_blockname</span>
</pre>
</div>

<p>
so a link to such a block would have the format <code>[[blk:my-block]]</code> or <code>[[blk:my-block][link description here]]</code>.
</p>

<p>
in addition, the title of an org-block can have an alias:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+begin_blockname</span> <span style="color: #fb4933;">:name</span> my-block <span style="color: #fb4933;">:title</span> my title <span style="color: #fb4933;">:alias</span> my second title
this is my block
<span style="color: #fb4933;">#+end_blockname</span>
</pre>
</div>

<p>
so that the block can be navigated to either by the main title, or its aliases.
</p>
</div>
</div>
<div id="outline-container-org8a1e1bb" class="outline-3">
<h3 id="org8a1e1bb">org-mode headers</h3>
<div class="outline-text-3" id="text-org8a1e1bb">
<p>
again, this is just the usual way, the id is created by <code>org-id-get-create</code> and the title is inserted manually:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fabd2f;">* my header title</span>
:PROPERTIES:
:ID:       0e7165f6-27e8-4e56-a342-b00572b7fff2
:END:
</pre>
</div>
</div>
</div>
<div id="outline-container-org9a0fd7d" class="outline-3">
<h3 id="org9a0fd7d">org-mode named targets</h3>
<div class="outline-text-3" id="text-org9a0fd7d">
<p>
a named target is a link to a specific location in text, the location is identified in the following way:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">this is my very long sentence that has a <span style="color: #fb4933;">&lt;&lt;&lt;target&gt;&gt;&gt;</span> in it.
</pre>
</div>

<p>
a link to the target can be inserted using <code>[[blk:target]]</code>.
</p>
</div>
</div>
<div id="outline-container-orgf7d2110" class="outline-3">
<h3 id="orgf7d2110">markdown headers</h3>
<div class="outline-text-3" id="text-orgf7d2110">
<p>
a markdown header isnt identified (by default) but can be navigated to by its title, the reason for this is that i didnt find a common way to identify markdown headers.
</p>
<div class="org-src-container" data-language="markdown">
<pre class="src src-markdown"><span style="color: #7c6f64;"># </span><span style="color: #83a598;">my markdown header</span>
</pre>
</div>

<p>
notice that you can always just insert a link using the title (if <code>blk-treat-titles-as-ids</code> is <code>t</code>): <code>[[blk:my markdown header][my description here]]</code>. 
</p>
</div>
</div>
<div id="outline-container-orgf23f3ab" class="outline-3">
<h3 id="orgf23f3ab">linking to an elisp function</h3>
<div class="outline-text-3" id="text-orgf23f3ab">
<div class="org-src-container" data-language="emacs-lisp">
<pre class="src src-emacs-lisp"><span style="color: #458588;">(</span><span style="color: #fb4933;">defun</span> <span style="color: #fabd2f;">my-function</span> <span style="color: #b16286;">()</span>
  <span style="color: #458588;">)</span>
</pre>
</div>

<p>
as usual, a link can be inserted using <code>[[blk:my-function][link description here]]</code>.
</p>
</div>
</div>
<div id="outline-container-org60a565b" class="outline-3">
<h3 id="org60a565b">latex labels</h3>
<div class="outline-text-3" id="text-org60a565b">
<p>
a block of latex can be identified by its <code>\label</code> (both in <code>.org</code> and <code>.tex</code> files):
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #b8bb26;">\begin{equation}\label{my-equation}</span>
<span style="color: #b8bb26;">  f(x) := \sqrt{x} + 1</span>
<span style="color: #b8bb26;">\end{equation}</span>
</pre>
</div>

<p>
or, as an alternative (in org-mode files), we can also use:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+name</span>: my-equation
<span style="color: #b8bb26;">\begin{equation}</span>
<span style="color: #b8bb26;">  f(x) := \sqrt{x} + 1</span>
<span style="color: #b8bb26;">\end{equation}</span>
</pre>
</div>

<p>
a link is inserted using <code>[[blk:my-equation][my description]]</code>.
</p>
</div>
</div>
<div id="outline-container-orge40f494" class="outline-3">
<h3 id="orge40f494">outline navigation</h3>
<div class="outline-text-3" id="text-orge40f494">
<p>
(poorly-phrased,) the <b>grouping</b> feature allows to group certain rules together to form "outlines", which are titles of nodes that are in the same file, that form an "outline" or a "path" to the target.
</p>

<p>
consider an org-mode file with the following contents:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org">:PROPERTIES:
:ID:       35265ce3-3226-46f6-b690-2f5630a3b9f0
:END:
<span style="color: #fb4933;">#+title</span>: my test org mode file
<span style="color: #fabd2f;">* this is my first header</span>
this is some random text
<span style="color: #fabd2f;">* this is my second header</span>
this is some random text
<span style="color: #fb4933;">#+begin_src</span> python <span style="color: #fb4933;">:name</span> my-python-block
  import os
  os.system('ls')
<span style="color: #fb4933;">#+end_src</span>
</pre>
</div>

<p>
when invoking <code>blk-find</code>, this is what we are presented with:
<img src="/Thu_Aug_22_09:09:25_PM_IDT_2024.png" />
</p>
</div>
</div>
<div id="outline-container-orgb18986d" class="outline-3">
<h3 id="orgb18986d">latex transclusions</h3>
<div class="outline-text-3" id="text-orgb18986d">
<p>

<video controls muted>
  <source src='/tex_transclusion.mp4' type='video/mp4'>
your browser does not support the video tag.
</video>
</p>
</div>
</div>
</div>
<div id="outline-container-org19984b1" class="outline-2">
<h2 id="org19984b1">writing custom rules</h2>
<div class="outline-text-2" id="text-org19984b1">
<p>
when im taking notes in math, what i like to do is write the following:
</p>
<div class="org-src-container" data-language="org">
<pre class="src src-org"><span style="color: #fb4933;">#+begin_definition</span> <span style="color: #fb4933;">:name</span> def-comp-fun <span style="color: #fb4933;">:defines</span> computable function <span style="color: #fb4933;">:alias</span> partially computable function
a /computable function/ is any function that is a member of the class of mu-recursive functions.
<span style="color: #fb4933;">#+end_definition</span>
</pre>
</div>

<p>
in my mind, <code>:defines</code> tells me what this block defines, <code>:alias</code> tells me that the following value is an alternative name to what <code>:defines</code> has, and <code>:name</code> is supposed to give the block a unique string it is identified by.
</p>

<p>
now, with the rules pre-defined in <code>blk.el</code>, it would be possible to use the keyword <code>:title</code> and have <code>blk</code> recognize it, but not <code>:defines</code>. to have blk recognize this new keyword, we add the following rule, which is a modified version of the rule <code>blk-rg-org-file-rule</code> from <code>blk.el</code>:
</p>
<div class="org-src-container" data-language="emacs-lisp">
<pre class="src src-emacs-lisp"><span style="color: #458588;">(</span>add-to-list
 'blk-patterns
 <span style="color: #b16286;">(</span>list <span style="color: #fe8019;">:title</span> <span style="color: #b8bb26;">"definition"</span>
       <span style="color: #fe8019;">:glob</span> <span style="color: #b8bb26;">"*.org"</span>
       <span style="color: #fe8019;">:anchor-regex</span> <span style="color: #b8bb26;">"(:defines)\\s+[</span><span style="color: #b8bb26;">^</span><span style="color: #b8bb26;">:]+"</span>
       <span style="color: #fe8019;">:title-function</span> 'blk-value-after-space-upto-colon
       <span style="color: #fe8019;">:extract-id-function</span> 'blk-org-id-at-point<span style="color: #b16286;">)</span><span style="color: #458588;">)</span>
</pre>
</div>

<p>
notice that this assumes that <code>blk-grepper</code> is set to <code>blk-grepper-rg</code> or <code>blk-grepper-grep</code> (this is true by default, depending on whether you have <code>rg</code> installed, see the <b>different greppers</b> section).
</p>

<p>
the value provided to <code>:anchor-regex</code> may look scary to someone who isnt very familiar with <a href="/unix_regex.html">unix regex</a>, but its really just a regex passed to the grepper to identify the keywords we're aiming for.
</p>

<p>
the roles of the keywords in the list above are described in the docstring of <code>blk-patterns</code>:
</p>
<div class="org-src-container" data-language="emacs-lisp">
<pre class="src src-emacs-lisp">The list of patterns to use with the blk grepper.
Each entry should be a plist representing the data of a pattern:
  <span style="color: #fe8019;">:title</span> is the title/type of the pattern <span style="color: #458588;">(</span>used for completing-read<span style="color: #458588;">)</span>.
  <span style="color: #fe8019;">:glob</span> is the glob pattern to matches files to be grepped.
  <span style="color: #fe8019;">:anchor-regex</span> is the regex for matching blocks of text that contain
    the target value which is then passed to <span style="color: #fe8019;">:title-function</span> to be
    turned into the final desired value to be passed to completing-read
    to serve as the entry in the completing-read menu for the target.
  <span style="color: #fe8019;">:src-id-function</span> is the function that gets the id to be used when
    creating links to the target<span style="color: #7c6f64;">; </span><span style="color: #7c6f64;">the need for :src-id-function over</span>
    <span style="color: #fe8019;">:title-function</span> is that an id and a name/title for a target can be
    different, as an id can be a random sequence but a name could be
    a more memorable sequence of characters.  the function takes the matched
    value and strips unnecessary turning it into just the id,
    think \label{my-id} -&gt; my-id
  <span style="color: #fe8019;">:title-function</span> is a function that takes as an argument the matched
    text and extracts the title from it.
    think <span style="color: #b8bb26;">"#+title: my-title"</span> -&gt; <span style="color: #b8bb26;">"my-title"</span>.
  <span style="color: #fe8019;">:transclusion-function</span> is a function that should take
    the match and return an object or plist that can be handled by
    org-transclusion, this allows for easily defining custom transclusion
    functions for different patterns of text.  see the function
    `<span style="color: #d3869b;">blk-org-trancslusion-at-point</span>' for an example.
  <span style="color: #fe8019;">:extract-id-function</span> is a function that, given a title, opens the
    destination entry using the gathered metadata and grabs the id
    that corresponds to a particular entry.  for example, given a
    result that matched the title of an org file, this function
    is called after opening the org file, the grep-result is passed
    to it, it should return the id of the org file that was opened.
    this is needed because when grepping we cant tell which id is
    is associated with which title <span style="color: #458588;">(</span>even if they're in the same file
    or belong to the same portion of text<span style="color: #458588;">)</span><span style="color: #fb4933; font-weight: bold;">.</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbab6db4" class="outline-2">
<h2 id="orgbab6db4">different greppers</h2>
<div class="outline-text-2" id="text-orgbab6db4">
<p>
the greppers available for use are currently the standard <code>grep</code> or <code>ripgrep</code> (<code>rg</code>), or <code>emacs</code> itself. only use emacs as the grepper if you really are trying to avoid the dependency of an external grepper as it is an order of magnitude slower than the other options, though it is good to note that the plus side of using emacs as the grepper is that it is aware of unsaved changes to buffers since it greps those instead of the files themselves when they're already opened in buffers.
</p>

<p>
for each grepper a different table of patterns is defined, the grepper is chosen by setting the variable <code>blk-grepper</code> and defaults to <code>rg</code> and falls back to <code>grep</code> if <code>rg</code> isnt installed, and falls back to using emacs if <code>grep</code> isnt found aswell.
</p>

<ul class="org-ul">
<li><code>blk-grepper-rg</code> <?xml version='1.0' encoding='UTF-8'?>

<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 -3.655041 18.264938 2.328761' style="max-height: 0.4087em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline">
<defs>
<path id='g0-40' d='m9.39477-1.524284c0-.199253-.18929-.199253-.33873-.199253h-6.136986c-.159402 0-.179328 0-.308842-.099626c-.468244-.348692-.936488-.577833-1.135741-.667497c.209215-.089664 .667497-.318804 1.145704-.667497c.119552-.099626 .139477-.099626 .298879-.099626h6.136986c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.877958c.806974-.876712 .996264-1.424658 .996264-1.454545c0-.119552-.109589-.119552-.199253-.119552c-.14944 0-.14944 .009963-.249066 .18929c-.508095 .966376-1.424658 1.972603-2.998755 2.420922c-.119552 .029888-.169365 .049813-.169365 .129514s.049813 .099626 .159402 .129514c1.594022 .448319 2.49066 1.454545 2.978829 2.361146c.109589 .18929 .109589 .209215 .129514 .219178c.039851 .029888 .089664 .029888 .14944 .029888c.089664 0 .199253 0 .199253-.119552c0 0-.18929-.56787-.996264-1.454545h5.877958c.139477 0 .328767 0 .328767-.199253z'/>
<path id='g0-41' d='m9.384807-2.49066c0-.079701-.049813-.099626-.159402-.129514c-1.594022-.448319-2.49066-1.454545-2.978829-2.361146c-.109589-.18929-.109589-.209215-.129514-.219178c-.039851-.029888-.089664-.029888-.14944-.029888c-.089664 0-.199253 0-.199253 .119552c0 0 .18929 .56787 .996264 1.454545h-5.877958c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h6.136986c.159402 0 .179328 0 .308842 .099626c.468244 .348692 .936488 .577833 1.135741 .667497c-.209215 .089664-.667497 .318804-1.145704 .667497c-.119552 .099626-.139477 .099626-.298879 .099626h-6.136986c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.877958c-.806974 .876712-.996264 1.424658-.996264 1.454545c0 .119552 .109589 .119552 .199253 .119552c.14944 0 .14944-.009963 .249066-.18929c.508095-.966376 1.424658-1.972603 2.998755-2.420922c.119552-.029888 .169365-.049813 .169365-.129514z'/>
</defs>
<g id='page1'>
<g fill='currentColor'>
<use x='0' y='0' xlink:href='#g0-40'/>
<use x='8.302269' y='0' xlink:href='#g0-41'/>
</g>
</g>
</svg> <code>blk-rg-patterns</code></li>
<li><code>blk-grepper-grep</code> <?xml version='1.0' encoding='UTF-8'?>

<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 -3.655041 18.264938 2.328761' style="max-height: 0.4087em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline">
<defs>
<path id='g0-40' d='m9.39477-1.524284c0-.199253-.18929-.199253-.33873-.199253h-6.136986c-.159402 0-.179328 0-.308842-.099626c-.468244-.348692-.936488-.577833-1.135741-.667497c.209215-.089664 .667497-.318804 1.145704-.667497c.119552-.099626 .139477-.099626 .298879-.099626h6.136986c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.877958c.806974-.876712 .996264-1.424658 .996264-1.454545c0-.119552-.109589-.119552-.199253-.119552c-.14944 0-.14944 .009963-.249066 .18929c-.508095 .966376-1.424658 1.972603-2.998755 2.420922c-.119552 .029888-.169365 .049813-.169365 .129514s.049813 .099626 .159402 .129514c1.594022 .448319 2.49066 1.454545 2.978829 2.361146c.109589 .18929 .109589 .209215 .129514 .219178c.039851 .029888 .089664 .029888 .14944 .029888c.089664 0 .199253 0 .199253-.119552c0 0-.18929-.56787-.996264-1.454545h5.877958c.139477 0 .328767 0 .328767-.199253z'/>
<path id='g0-41' d='m9.384807-2.49066c0-.079701-.049813-.099626-.159402-.129514c-1.594022-.448319-2.49066-1.454545-2.978829-2.361146c-.109589-.18929-.109589-.209215-.129514-.219178c-.039851-.029888-.089664-.029888-.14944-.029888c-.089664 0-.199253 0-.199253 .119552c0 0 .18929 .56787 .996264 1.454545h-5.877958c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h6.136986c.159402 0 .179328 0 .308842 .099626c.468244 .348692 .936488 .577833 1.135741 .667497c-.209215 .089664-.667497 .318804-1.145704 .667497c-.119552 .099626-.139477 .099626-.298879 .099626h-6.136986c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.877958c-.806974 .876712-.996264 1.424658-.996264 1.454545c0 .119552 .109589 .119552 .199253 .119552c.14944 0 .14944-.009963 .249066-.18929c.508095-.966376 1.424658-1.972603 2.998755-2.420922c.119552-.029888 .169365-.049813 .169365-.129514z'/>
</defs>
<g id='page1'>
<g fill='currentColor'>
<use x='0' y='0' xlink:href='#g0-40'/>
<use x='8.302269' y='0' xlink:href='#g0-41'/>
</g>
</g>
</svg> <code>blk-grep-patterns</code></li>
<li><code>blk-grepper-emacs</code> <?xml version='1.0' encoding='UTF-8'?>

<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 -3.655041 18.264938 2.328761' style="max-height: 0.4087em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline">
<defs>
<path id='g0-40' d='m9.39477-1.524284c0-.199253-.18929-.199253-.33873-.199253h-6.136986c-.159402 0-.179328 0-.308842-.099626c-.468244-.348692-.936488-.577833-1.135741-.667497c.209215-.089664 .667497-.318804 1.145704-.667497c.119552-.099626 .139477-.099626 .298879-.099626h6.136986c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.877958c.806974-.876712 .996264-1.424658 .996264-1.454545c0-.119552-.109589-.119552-.199253-.119552c-.14944 0-.14944 .009963-.249066 .18929c-.508095 .966376-1.424658 1.972603-2.998755 2.420922c-.119552 .029888-.169365 .049813-.169365 .129514s.049813 .099626 .159402 .129514c1.594022 .448319 2.49066 1.454545 2.978829 2.361146c.109589 .18929 .109589 .209215 .129514 .219178c.039851 .029888 .089664 .029888 .14944 .029888c.089664 0 .199253 0 .199253-.119552c0 0-.18929-.56787-.996264-1.454545h5.877958c.139477 0 .328767 0 .328767-.199253z'/>
<path id='g0-41' d='m9.384807-2.49066c0-.079701-.049813-.099626-.159402-.129514c-1.594022-.448319-2.49066-1.454545-2.978829-2.361146c-.109589-.18929-.109589-.209215-.129514-.219178c-.039851-.029888-.089664-.029888-.14944-.029888c-.089664 0-.199253 0-.199253 .119552c0 0 .18929 .56787 .996264 1.454545h-5.877958c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h6.136986c.159402 0 .179328 0 .308842 .099626c.468244 .348692 .936488 .577833 1.135741 .667497c-.209215 .089664-.667497 .318804-1.145704 .667497c-.119552 .099626-.139477 .099626-.298879 .099626h-6.136986c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.877958c-.806974 .876712-.996264 1.424658-.996264 1.454545c0 .119552 .109589 .119552 .199253 .119552c.14944 0 .14944-.009963 .249066-.18929c.508095-.966376 1.424658-1.972603 2.998755-2.420922c.119552-.029888 .169365-.049813 .169365-.129514z'/>
</defs>
<g id='page1'>
<g fill='currentColor'>
<use x='0' y='0' xlink:href='#g0-40'/>
<use x='8.302269' y='0' xlink:href='#g0-41'/>
</g>
</g>
</svg> <code>blk-emacs-patterns</code></li>
</ul>
<p>
the rules that are passed to the grepper are stored in <code>blk-patterns</code>, which initially equals one of the variables listed above, but may differ if the user modifies it directly.
</p>
</div>
</div>
<div id="outline-container-orgd49980a" class="outline-2">
<h2 id="orgd49980a">dumping the data</h2>
<div class="outline-text-2" id="text-orgd49980a">
<p>
<code>blk</code> provides the function <code>blk-all-to-json</code> to dump the data that it gathers from files into a json file, for external use.
</p>
</div>
</div>
<div id="outline-container-org3228d27" class="outline-2">
<h2 id="org3228d27">variables for customization</h2>
<div class="outline-text-2" id="text-org3228d27">
<p>
the following variables can be used to change some behaviors in the package.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">variable</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>blk-directories</code></td>
<td class="org-left">the list of directories to search for entries in</td>
</tr>

<tr>
<td class="org-left"><code>blk-search-recursively</code></td>
<td class="org-left">whether to grep directories recursively (false by default, for obvious reasons)</td>
</tr>

<tr>
<td class="org-left"><code>blk-enable-groups</code></td>
<td class="org-left">whether to enable outline navigation, like org-file/org-header</td>
</tr>

<tr>
<td class="org-left"><code>blk-use-cache</code></td>
<td class="org-left">whether to cache results for faster retrieval</td>
</tr>

<tr>
<td class="org-left"><code>blk-cache-update-interval</code></td>
<td class="org-left">how often to update the cached results (in seconds)</td>
</tr>

<tr>
<td class="org-left"><code>blk-tex-env-at-point-function</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>blk-treat-titles-as-ids</code></td>
<td class="org-left">whether to enable linking by title without the need for id</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org1ffc8c1" class="outline-2">
<h2 id="org1ffc8c1">known issues</h2>
<div class="outline-text-2" id="text-org1ffc8c1">
</div>
<div id="outline-container-org6fbe93a" class="outline-3">
<h3 id="org6fbe93a">blk-grepper-grep doesnt handle whitespaces in filepaths</h3>
<div class="outline-text-3" id="text-org6fbe93a">
<p>
when using <code>blk-grepper-grep</code>, i.e., when <code>blk-grepper</code> is set to <code>blk-grepper-grep</code>, blk fails to work and simply errors out if one of the files resulting from glob expansions contains a space. this happens because we expand the globs "manually" in the shell command without quoting the filenames, which is done because <code>gnu grep</code> doesnt handle globs like <code>rg</code> can. this can be easily addressed by modifying the shell command defined in <code>blk-grepper-grep</code>, but it would overcompliate the shell command. for now i suggest using <code>blk-grepper-rg</code> (until i decide how to fix this):
</p>
<div class="org-src-container" data-language="emacs-lisp">
<pre class="src src-emacs-lisp"><span style="color: #458588;">(</span><span style="color: #fb4933;">setq</span> blk-grepper blk-grepper-rg<span style="color: #458588;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
